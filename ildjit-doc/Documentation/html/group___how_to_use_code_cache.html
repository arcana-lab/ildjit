<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>ILDJIT: IR code cache</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ildjit_logo_small.jpeg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ILDJIT
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">IR code cache<div class="ingroups"><a class="el" href="group___overview.html">Overview</a> &raquo; <a class="el" href="group___compilation_schemes.html">Compilation schemes</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for IR code cache:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group___how_to_use_code_cache.png" border="0" alt="" usemap="#group______how__to__use__code__cache"/>
<map name="group______how__to__use__code__cache" id="group______how__to__use__code__cache">
<area shape="rect" id="node1" href="group___compilation_schemes.html" title="Compilation schemes" alt="" coords="5,5,152,32"/></map>
</td></tr></table></center>
</div>
<p>ILDJIT can use the IR code cache. The IR code cache is a directory in the file system where the IR code is stored. Inside this directory, ILDJIT loads old IR code previously generated and/or stores new IR code newly generated.</p>
<p><br />
</p>
<hr/>
<p> <b> Set the ILDJIT IR code cache </b> </p><hr/>
<p> The IR code cache is defined by the environment variable <code>ILDJIT_CACHE</code>.</p>
<p>The default root directory of the IR code cache is the home of the user (e.g. /home/MYUSERNAME). In order to change the directory, the environment variable <code>ILDJIT_CACHE</code> can be used: </p><div class="fragment"><div class="line">$ export ILDJIT_CACHE=/home/xan/MyNewCodeCache</div>
</div><!-- fragment --><p><br />
</p>
<hr/>
<p> <b> Use of the ILDJIT IR code cache in static compilation schemes </b> </p><hr/>
<p> When a static compilation scheme is used (e.g. &ndash;static, &ndash;aot), ILDJIT first checks if the IR code of the program has been already generated and stored into the IR code cache (e.g. /home/xan/MyNewCodeCache). If the IR code is available, then ILDJIT loads that code and it follows the next steps declared by the compilation scheme in use (e.g., generate the machine code and run it). Otherwise, if the IR code is not available in the IR code cache, ILDJIT generates and optimizes the IR, it stores the optimized IR to the code cache and then it follows the next steps (e.g. generate the machine code and run it).</p>
<p><br />
</p>
<hr/>
<p> <b> Example </b> </p><hr/>
<p> Consider the following case where we setup a custom code cache.</p>
<p>Let's assume that we have a CIL program called <code>myProgram.cil</code>. This file can be generated by using <a href="http://www.irisa.fr/alf/index.php?option=com_content&amp;view=article&amp;id=38%3Agcc4cli-a-cli-backend-for-gcc&amp;catid=3%3Aprojects&amp;Itemid=3&amp;lang=en">GCC</a> or <a href="http://www.mono-project.com/Main_Page">Mono</a>. For example: </p><div class="fragment"><div class="line">$ cil32-gcc -o myProgram.cil myProgram.c</div>
</div><!-- fragment --><p>First, we create the code cache directory </p><div class="fragment"><div class="line">$ export ILDJIT_CACHE=/home/xan/MyNewCodeCache</div>
<div class="line">$ mkdir -p $ILDJIT_CACHE</div>
</div><!-- fragment --><p> The code cache at this point is empty </p><div class="fragment"><div class="line">$ ls -a $ILDJIT_CACHE</div>
<div class="line">$</div>
</div><!-- fragment --><p>We generate the IR code of the program <code>myProgram.cil</code> without executing it: </p><div class="fragment"><div class="line">$ ildjit --<span class="keyword">static</span> -O1 -s myProgram.cil</div>
</div><!-- fragment --><p> At this point, there is an entry into the IR code cache where the IR code of <code>myProgram.cil</code> has been stored: </p><div class="fragment"><div class="line">$ ls -a $ILDJIT_CACHE</div>
<div class="line">  .ildjit</div>
<div class="line">$ ls -a $ILDJIT_CACHE/.ildjit</div>
<div class="line">  manfred</div>
<div class="line">$ ls -a $ILDJIT_CACHE/.ildjit/manfred</div>
<div class="line">  myProgram.cil</div>
</div><!-- fragment --><p> The IR code has been stored in the directory <code>myProgram.cil</code>.</p>
<p>Now, we can generate the machine code starting from the IR that has been previously generated. </p><div class="fragment"><div class="line">$ ildjit --<span class="keyword">static</span> myProgram.cil</div>
</div><!-- fragment --><p> This run did not change the IR code cache.</p>
<p>These last two passes can be collapsed by executing the following command: </p><div class="fragment"><div class="line">$ ildjit --<span class="keyword">static</span> -O1 myProgram.cil</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 30 2014 10:00:57 for ILDJIT by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
