<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>ILDJIT: Debugging</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ildjit_logo_small.jpeg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ILDJIT
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Debugging<div class="ingroups"><a class="el" href="group___plugins.html">Plugins</a> &raquo; <a class="el" href="group___i_r_code_optimization.html">Codetools</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Debugging:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group___i_r_debugging.png" border="0" alt="" usemap="#group______i__r__debugging"/>
<map name="group______i__r__debugging" id="group______i__r__debugging">
<area shape="rect" id="node2" href="group___i_r_code_optimization.html" title="Codetools" alt="" coords="5,5,85,32"/></map>
</td></tr></table></center>
</div>
<p>Now, suppose your plugin does not work as expected.</p>
<p>In order to simplify the debugging procedure, printing the IR produced by the plugin is a good way to go. This can be done by downloading, compiling and installing the optimization-dotprinter plugin (if you have used the default ILDJIT installer, you have already it within your system). As every other plugin, dotprinter can be called from your plugin. In particular, you can add the following line within your code (hence also within your do_job procedure): </p><div class="fragment"><div class="line"><a class="code" href="group___invoke_codetools.html#ga4e6f2b9247140cd4be46cfc42e3b047b">IROPTIMIZER_callMethodOptimization</a>(lib, method, <a class="code" href="group___codetools.html#gab8cdb84c8212a30119375ff4370069f8">METHOD_PRINTER</a>);</div>
</div><!-- fragment --><p> This line has to be added every time you want to print the code of the method being optimized.</p>
<p>A good practice is to print the IR code immediately before and after the execution of the plugin to debug in order to detect the modifications that have been done. So, for example, if <code> do_job </code> is the function body provided by your plugin, you need to modify it in the following way: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> do_job (<a class="code" href="structir__method__t.html">ir_method_t</a> *method){</div>
<div class="line">    <a class="code" href="group___invoke_codetools.html#ga4e6f2b9247140cd4be46cfc42e3b047b">IROPTIMIZER_callMethodOptimization</a>(lib, method, <a class="code" href="group___codetools.html#gab8cdb84c8212a30119375ff4370069f8">METHOD_PRINTER</a>);</div>
<div class="line">    ... <span class="comment">// your code</span></div>
<div class="line">    <a class="code" href="group___invoke_codetools.html#ga4e6f2b9247140cd4be46cfc42e3b047b">IROPTIMIZER_callMethodOptimization</a>(lib, method, <a class="code" href="group___codetools.html#gab8cdb84c8212a30119375ff4370069f8">METHOD_PRINTER</a>);</div>
<div class="line">    return ;</div>
<div class="line">}</div>
</div><!-- fragment --><p> When you run ildjit with: </p><div class="fragment"><div class="line">iljit -On test.exe</div>
</div><!-- fragment --><p> (with 'n' set to the appropriate optimization level, as explained before) a series of ILDJIT*.cfg files will be produced. Each of them will contain the control flow graphs for the method whose name identifies the file.</p>
<p>In order to view them, you must have the dot program installed (you can find it in your linux distribution repositories, usually in the graphviz package). Typing </p><div class="fragment"><div class="line">dot -Tsvg -O filename.cfg</div>
</div><!-- fragment --><p> will produce one SVG file for each graph. These files can then be opened with firefox, or with inkscape </p><div class="fragment"><div class="line">firefox *.svg</div>
</div><!-- fragment --><p> Looking at the Control Flow Graphs contained in these files, it is much easier to understand what modifications have been done by the plugin, and whether they are correct or not.</p>
<p>In oder to understand IR methods, Section <a class="el" href="group___i_r_language.html">IR API</a> describes the IR language by means of data types and the instructions set. The same section provides information on the API that can be used by plugins in order to manage IR methods.</p>
<p>Next: <a class="el" href="group___system_a_p_i.html">System API</a> </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 30 2014 10:00:57 for ILDJIT by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
